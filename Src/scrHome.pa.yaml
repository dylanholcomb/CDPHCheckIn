# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  scrHome:
    Properties:
      Fill: =RGBA(204, 231, 246, 1)
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |-
        =// Refresh the data source so all named formulas (colToday, checkedin,
        // checkedout, varTodayItem, varTotalHours) auto-recalculate from fresh SP data.
        Refresh(spo_LogList);
    Children:
      - lblHeader:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =117
            Size: =20
            Text: |-
              ="Welcome, " & varUserFullName & "!

              Daily Assignment: Check-In / Check-Out"
            Width: =635
            X: =386
            Y: =235
      - btnCheckIn:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: |-
              =If(
                  checkedout,            // If the user has already checked out today
                  DisplayMode.Disabled,
                  If(
                      checkedin,         // After check-in (before check-out)
                      DisplayMode.Disabled,
                      DisplayMode.Edit   // Only enabled when nothing is done
                  )
              )
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.Arial
            Height: =177
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Navigate(scrCheckIn,ScreenTransition.Fade)
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =25
            Text: ="Check-In"
            Tooltip: ="Click Here To Check In"
            Width: =293
            X: =256
            Y: =388
      - btnCheckOut:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: |-
              =If(
                  checkedout,            // Already checked out today
                  DisplayMode.Disabled,
                  If(
                      checkedin,         // Can only check out after check-in
                      DisplayMode.Edit,
                      DisplayMode.Disabled
                  )
              )
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.Arial
            Height: =177
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Navigate(scrCheckOut,ScreenTransition.Fade)
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =25
            Text: ="Check-Out"
            Tooltip: ="Click Here To Check Out"
            Width: =295
            X: =856
            Y: =388
      - imgCDPH:
          Control: Image@2.2.3
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Height: =170
            Image: ='primary-rgb-full-color (1)'
            Width: =324
            X: =519
            Y: =31
      - lblStatus:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Right
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.Arial
            Height: =68
            Size: =18
            Text: |+
              =If(
                  !IsBlank(varTodayItem.CheckOutTime),
                  "Status: Checked Out at " & Text(varTodayItem.CheckOutTime, "h:mm am/pm"),

                  !IsBlank(varTodayItem.BreakTimeOut) && IsBlank(varTodayItem.BreakTimeIn),
                  "Status: Temporarily Check-out At " &
                      Text(varTodayItem.BreakTimeOut, "h:mm am/pm"),

                  !IsBlank(varTodayItem.BreakTimeIn),
                  "Status: Checked Back In At " &
                      Text(varTodayItem.BreakTimeIn, "h:mm am/pm"),

                  !IsBlank(varTodayItem.CheckInTime),
                  "Status: Checked In At " &
                      Text(varTodayItem.CheckInTime, "h:mm am/pm"),

                  "Status: Not Checked In Yet."
              )
            Width: =544
            X: =789
            Y: =685
      - btnAddOvertime:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: |-
              =If(
                  CountRows(colToday) > 0 &&
                  !IsBlank(First(colToday).OvertimeHours),
                  DisplayMode.Disabled,   // OT already saved â†’ greyed out
                  DisplayMode.Edit        // OT not saved yet
              )
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.Arial
            Height: =71
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Navigate(scrOvertime, ScreenTransition.Fade)
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =25
            Text: ="Add Overtime"
            Visible: |-
              =checkedin && 
              checkedout &&
              CountRows(colToday) > 0 &&
              varTotalHours >= 8
            Width: =229
            X: =595
            Y: =666
      - lblOvertimeSummary:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Font: =Font.Arial
            Height: =39
            Size: =18
            Text: |-
              ="Overtime Hours Submitted: " & Text(First(colToday).OvertimeHours, "0.0")
            Visible: |-
              =CountRows(colToday) > 0 &&
              !IsBlank(First(colToday).OvertimeHours)
            Width: =384
            X: =37
            Y: =698
      - ButtonBreakLeave:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: |-
              =If(
                  CountRows(colToday) > 0 &&
                  checkedin && !checkedout &&
                  IsBlank(varTodayItem.BreakTimeOut),
                  DisplayMode.Edit,
                  DisplayMode.Disabled
              )
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: |-
              =Patch(
                  spo_LogList,
                  varTodayItem,
                  { BreakTimeOut: Now() }
              );

              // varTodayItem auto-recalculates via App.Formulas after Refresh.
              Refresh(spo_LogList);
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Text: ="Leave"
            Tooltip: ="Use This Button When You Are Temporarily Away"
            X: =629
            Y: =413
      - ButtonBreakReturn:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisplayMode: |-
              =If(
                  CountRows(colToday) > 0 &&
                  checkedin && !checkedout &&
                  !IsBlank(varTodayItem.BreakTimeOut) &&
                  IsBlank(varTodayItem.BreakTimeIn),
                  DisplayMode.Edit,
                  DisplayMode.Disabled
              )
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: |-
              =Patch(
                  spo_LogList,
                  varTodayItem,
                  { BreakTimeIn: Now() }
              );

              // varTodayItem auto-recalculates via App.Formulas after Refresh.
              Refresh(spo_LogList);
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Text: ="Return"
            Tooltip: ="Use This Button When You Want To Return From Your Temporary Leave"
            X: =629
            Y: =505
      - ManagerAccess:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            Height: =55
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Navigate(scrManager)
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Text: ="Manager Access"
            Visible: =varIsManager
            Width: =182
            X: =40
            Y: =40
