# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  scrManager:
    Properties:
      Fill: =RGBA(210, 229, 247, 1)
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |-
        =// varUserEmail and varIsManager are named formulas â€” no Set() needed.
        // AddColumns avoids the old ForAll+Collect pattern (which ran a separate
        // LookUp per employee). This is cleaner and easier to read.
        ClearCollect(
            colMyEmps,
            AddColumns(
                Filter(
                    'Employee Members',
                    Lower(Trim(ManagerUPN)) = varUserEmail
                ),
                "EmpName", Name,
                "EmpUPN",  Lower(Trim(UPN)),
                "EmpStatus",
                    Coalesce(
                        LookUp(
                            spo_LogList,
                            Lower(Trim(EmployeeUPN)) = Lower(Trim(UPN)) &&
                            DateValue(Date) = Today(),
                            Status
                        ).Value,
                        "No entry today"
                    ),
                "EmpCheckInTime",
                    LookUp(
                        spo_LogList,
                        Lower(Trim(EmployeeUPN)) = Lower(Trim(UPN)) &&
                        DateValue(Date) = Today(),
                        CheckInTime
                    )
            )
        );
    Children:
      - Gallery1:
          Control: Gallery@2.15.0
          Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderThickness: =2
            Height: =534
            Items: =colMyEmps
            OnSelect: =
            ShowNavigation: =true
            TemplateSize: =89
            Width: =1262
            X: =46
            Y: =114
          Children:
            - Status:
                Control: Label@2.5.1
                Properties:
                  BorderColor: '=If(ThisItem.EmpStatus="Checked In", Color.Green, Color.Black) '
                  BorderThickness: =4
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Height: =49
                  OnSelect: =Select(Parent)
                  Text: =ThisItem.EmpStatus
                  Width: =164
                  X: =762
                  Y: =16
            - CheckInTime:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Font: =Font.'Open Sans'
                  Height: =39
                  Text: |-
                    =If(
                        IsBlank(ThisItem.EmpCheckInTime),
                        "",
                        TimeValue(ThisItem.EmpCheckInTime,"en-us")
                    )
                  Width: =159
                  X: =981
                  Y: =21
            - UPN:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =32
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =18
                  Text: =ThisItem.EmpUPN
                  VerticalAlign: =VerticalAlign.Top
                  Width: =335
                  X: =372
                  Y: =28
            - Name:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(50, 49, 48, 1)
                  Font: =Font.Arial
                  FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                  Height: =38
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =20
                  Text: =ThisItem.EmpName
                  VerticalAlign: =VerticalAlign.Top
                  Width: =341
                  X: =14
                  Y: =27
            - NextArrow1:
                Control: Classic/Icon@2.5.0
                Properties:
                  AccessibleLabel: =Self.Tooltip
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(166, 166, 166, 1)
                  DisabledBorderColor: =RGBA(56, 56, 56, 1)
                  DisabledColor: =RGBA(119, 119, 119, 1)
                  Height: =50
                  Icon: =Icon.ChevronRight
                  OnSelect: |-
                    =Set(
                        varSelectedLog,
                        LookUp(
                            spo_LogList,
                            Lower(Trim(EmployeeUPN)) = Lower(Trim(ThisItem.EmpUPN)) &&
                            DateValue(Date) = Today()
                        )
                    );

                    If(
                        IsBlank(varSelectedLog),
                        Notify("No log entry found for this employee today.", NotificationType.Information),
                        Navigate(scrManagerDetail, ScreenTransition.Fade)
                    )
                  PaddingBottom: =16
                  PaddingLeft: =16
                  PaddingRight: =16
                  PaddingTop: =16
                  Tooltip: ="View item details"
                  Width: =50
                  X: =Parent.TemplateWidth - Self.Width - 12
                  Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            - Separator1:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, 1)
                  Height: =8
                  OnSelect: =Select(Parent)
                  Width: =Parent.TemplateWidth
                  Y: =Parent.TemplateHeight - Self.Height
            - Rectangle1:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(0, 18, 107, 1)
                  Height: =Parent.TemplateHeight - Separator1.Height
                  OnSelect: =Select(Parent)
                  Visible: =ThisItem.IsSelected
                  Width: =4
      - mngName:
          Control: Text@0.0.51
          Properties:
            Font: =Font.Arial
            Size: =25
            Text: ="Name"
            Weight: ='TextCanvas.Weight'.Bold
            X: =54
            Y: =45
      - mngUPN:
          Control: Text@0.0.51
          Properties:
            Font: =Font.Arial
            Size: =25
            Text: ="UPN"
            Weight: ='TextCanvas.Weight'.Bold
            X: =423
            Y: =45
      - mngStatus:
          Control: Text@0.0.51
          Properties:
            Font: =Font.Arial
            Size: =25
            Text: ="Status"
            Weight: ='TextCanvas.Weight'.Bold
            X: =807
            Y: =45
      - mngTimeToday:
          Control: Text@0.0.51
          Properties:
            Font: =Font.Arial
            Size: =25
            Text: ="Time"
            Weight: ='TextCanvas.Weight'.Bold
            X: =1024
            Y: =45
      - backButton_1:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.Arial
            Height: =70
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: =Navigate(scrHome)
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            Size: =20
            Text: ="Back"
            Width: =173
            X: =46
            Y: =680
